# 计算机网络基础知识

-   计算机网络按照规模分为：广域网和局域网
-   计算机网络发展历程
    -   批处理阶段
    -   分时系统
    -   计算机通信

### OSI七层模型

![](https://notes-pic-cjs.oss-cn-chengdu.aliyuncs.com/obsidian/image_kDHh6zrwpx.png)

### TCP/IP四层模型

![](https://notes-pic-cjs.oss-cn-chengdu.aliyuncs.com/obsidian/image_hmZOfmJ79C.png)

### TCP/IP具体协议

#### IP协议

IP 是 `互联网协议(Internet Protocol)` ，位于网络层。IP是整个 TCP/IP 协议族的核心，也是构成互联网的基础。IP 能够为运输层提供数据分发，同时也能够组装数据供运输层使用。它将多个单个网络连接成为一个互联网，这样能够提高网络的可扩展性，实现大规模的网络互联。二是分割顶层网络和底层网络之间的耦合关系。

#### ICMP协议

ICMP 协议是 `Internet Control Message Protocol`， ICMP 协议主要用于在 IP 主机、路由器之间传递控制消息。ICMP 属于网络层的协议，当遇到 IP 无法访问目标、IP 路由器无法按照当前传输速率转发数据包时，会自动发送 ICMP 消息，从这个角度来说，ICMP 协议可以看作是 `错误侦测与回报机制`，让我们检查网络状况、也能够确保连线的准确性。

#### ARP协议

ARP 协议是 `地址解析协议`，即 `Address Resolution Protocol`，它能够根据 IP 地址获取物理地址。主机发送信息时会将包含目标 IP 的 ARP 请求广播到局域网络上的所有主机，并接受返回消息，以此来确定物理地址。收到消息后的物理地址和 IP 地址会在 ARP 中缓存一段时间，下次查询的时候直接从 ARP 中查询即可。

#### TCP协议

TCP 就是 `传输控制协议`，也就是 `Transmission Control Protocol`，它是一种面向连接的、可靠的、基于字节流的传输协议，TCP 协议位于传输层，TCP 协议是 TCP/IP 协议簇中的核心协议，它最大的特点就是提供可靠的数据交付。

TCP 的主要特点有 **慢启动、拥塞控制、快速重传、可恢复**。

#### UDP协议

UDP 协议就是 `用户数据报协议`，也就是 `User Datagram Protocol`，UDP 也是一种传输层的协议，与 TCP 相比，UDP 提供一种不可靠的数据交付，也就是说，UDP 协议不保证数据是否到达目标节点，也就是说，当报文发送之后，是无法得知其是否安全完整到达的。UDP 是一种无连接的协议，传输数据之前源端和终端无需建立连接，不对数据报进行检查与修改，无须等待对方的应答，会出现分组丢失、重复、乱序等现象。但是 UDP 具有较好的实时性，工作效率较 TCP 协议高。

#### FTP协议

FTP 协议是 `文件传输协议`，英文全称是 `File Transfer Protocol`，应用层协议之一，是 TCP/IP 协议的重要组成之一，FTP 协议分为服务器和客户端两部分，FTP 服务器用来存储文件，FTP 客户端用来访问 FTP 服务器上的文件，FTP 的传输效率比较高，所以一般使用 FTP 来传输大文件。

#### DNS 协议

DNS 协议是 `域名系统协议`，英文全称是 `Domain Name System`，它也是应用层的协议之一，DNS 协议是一个将域名和 IP 相互映射的分布式数据库系统。DNS 缓存能够加快网络资源的访问。

#### SMTP协议

SMTP 协议是 `简单邮件传输协议`，英文全称是 `Simple Mail Transfer Protocol`，应用层协议之一，SMTP 主要是用作邮件收发协议，SMTP 服务器是遵循 SMTP 协议的发送邮件服务器，用来发送或中转用户发出的电子邮件

#### SLIP 协议

SLIP 协议是指`串行线路网际协议（Serial Line Internet Protocol)`，是在串行通信线路上支持 TCP/IP 协议的一种`点对点(Point-to-Point`)式的链路层通信协议。

#### PPP 协议

PPP 协议是 `Point to Point Protocol`，即点对点协议，是一种链路层协议，是在为同等单元之间传输数据包而设计的。设计目的主要是用来通过拨号或专线方式建立点对点连接发送数据，使其成为各种主机、网桥和路由器之间简单连接的一种共通的解决方案。

### 网络的核心概念

#### 传输方式

一般分为面向连接和面向无连接

#### 分组交换

在互联网应用中，每个终端系统都可以彼此交换信息，这种信息也被称为 `报文(Message)`，报文是一个集大成者，它可以包括你想要的任何东西，比如文字、数据、电子邮件、音频、视频等。为了从源目的地向端系统发送报文，需要把长报文切分为一个个小的数据块，这种数据块称为`分组(Packets)`，也就是说，报文是由一个个小块的分组组成。在端系统和目的地之间，每个分组都要经过`通信链路(communication links)` 和`分组交换机(switch packets)` ，分组要在端系统之间交互需要经过一定的时间，如果两个端系统之间需要交互的分组为 L 比特，链路的传输速率为 R 比特/秒，那么传输时间就是 L / R秒。

#### 存储转发传输

存储转发传输指的就是交换机在转发分组的第一个比特前，必须要接受到整个分组，下面是一个存储转发传输的示意图，可以从图中窥出端倪

![](https://notes-pic-cjs.oss-cn-chengdu.aliyuncs.com/obsidian/image_zW2ZNuh0QO.png)

#### 排队时延和分组丢失

多个端系统同时给交换器发送分组，一定存在`顺序到达`和`排队`的问题。事实上，对于每条相连的链路，该分组交换机会有一个`输出缓存(output buffer)` 和 `输出队列(output queue)` 与之对应，它用于存储路由器准备发往每条链路的分组。如果到达的分组发现路由器正在接收其他分组，那么新到达的分组就会在输出队列中进行排队，这种等待分组转发所耗费的时间也被称为 `排队时延`，上面提到分组交换器在转发分组时会进行等待，这种等待被称为 `存储转发时延`，所以我们现在了解到的有两种时延，但是其实是有四种时延。这些时延不是一成不变的，其变化程序取决于网络的拥塞程度。

因为队列是有容量限制的，当多条链路同时发送分组导致输出缓存无法接受超额的分组后，这些分组会丢失，这种情况被称为 `丢包(packet loss)`，到达的分组或者已排队的分组将会被丢弃。

![](https://notes-pic-cjs.oss-cn-chengdu.aliyuncs.com/obsidian/image_Mdft1TAJXQ.png)

#### 转发表和路由器选择协议

**把不同端系统中的数据包进行存储和转发** 。在因特网中，每个端系统都会有一个 `IP` 地址，当原主机发送一个分组时，在分组的首部都会加上原主机的 IP 地址。每一台路由器都会有一个 `转发表(forwarding table)`，当一个分组到达路由器后，路由器会检查分组的目的地址的一部分，并用目的地址搜索转发表，以找出适当的传送链路，然后映射成为输出链路进行转发。

#### 电路交换

在计算机网络中，另一种通过网络链路和路由进行数据传输的另外一种方式就是 `电路交换(circuit switching)`。电路交换在`资源预留`上与分组交换不同，什么意思呢？就是分组交换不会预留每次端系统之间交互分组的缓存和链路传输速率，所以每次都会进行排队传输；而电路交换会预留这些信息。一个简单的例子帮助你理解：这就好比有两家餐馆，餐馆 A 需要预定而餐馆 B 不需要预定，对于可以预定的餐馆 A，我们必须先提前与其进行联系，但是当我们到达目的地时，我们能够立刻入座并选菜。而对于不需要预定的那家餐馆来说，你可能不需要提前联系，但是你必须承受到达目的地后需要排队的风险。

![](https://notes-pic-cjs.oss-cn-chengdu.aliyuncs.com/obsidian/image_x5PA9sFLYT.png)

#### 分组交换的时延

计算机网络中的分组从一台主机（源）出发，经过一系列路由器传输，在另一个端系统中结束它的历程。在这整个传输历程中，分组会涉及到四种最主要的时延：**节点处理时延(nodal processing delay)、排队时延(queuing delay)、传输时延(total nodal delay)和传播时延(propagation delay)**。这四种时延加起来就是 `节点总时延(total nodal delay)`。

如果用 dproc dqueue dtrans dpop 分别表示处理时延、排队时延、传输时延和传播时延，则节点的总时延由以下公式决定:  dnodal = dproc + dqueue + dtrans + dpop

![](https://notes-pic-cjs.oss-cn-chengdu.aliyuncs.com/obsidian/image_m45YmUswAN.png)

**节点处理时延**

`节点处理时延`分为两部分，第一部分是路由器会检查分组的首部信息；第二部分是决定将分组传输到哪条通信链路所需要的时间。一般高速网络的节点处理时延都在微妙级和更低的数量级。在这种处理时延完成后，分组会发往路由器的转发队列中

**排队时延**

在队列排队转发过程中，分组需要在队列中等待发送，分组在等待发送过程中消耗的时间被称为`排队时延`。排队时延的长短取决于先于该分组到达正在队列中排队的分组数量。如果该队列是空的，并且当前没有正在传输的分组，那么该分组的排队时延就是 0。如果处于网络高发时段，那么链路中传输的分组比较多，那么分组的排队时延将延长。实际的排队时延也可以到达微秒级。

**传输时延**

`队列` 是路由器所用的主要的数据结构。队列的特征就是先进先出，先到达食堂的先打饭。传输时延是理论情况下单位时间内的传输比特所消耗的时间。比如分组的长度是 L 比特，R 表示从路由器 A 到路由器 B 的传输速率。那么传输时延就是 L / R 。这是将所有分组推向该链路所需要的时间。真实情况下传输时延通常也在毫秒到微妙级

**传播时延**

从链路的起点到路由器 B 传播所需要的时间就是 `传播时延`。该比特以该链路的传播速率传播。该传播速率取决于链路的物理介质(双绞线、同轴电缆、光纤)。如果用公式来计算一下的话，该传播时延等于两台路由器之间的距离 / 传播速率。即传播速率是 `d/s` ，其中 d 是路由器 A 和 路由器 B 之间的距离，s 是该链路的传播速率。

#### 计算机网络中的吞吐量

除了丢包和时延外，衡量计算机另一个至关重要的性能测度是`端到端的吞吐量`。假如从主机 A 向主机 B 传送一个大文件，那么在任何时刻主机 B 接收到该文件的速率就是 `瞬时吞吐量(instantaneous throughput)`。如果该文件由 F 比特组成，主机 B 接收到所有 F 比特用去 T 秒，则文件的传送`平均吞吐量(average throughput)` 是 F / T bps。

### 单播、广播、多播和任播

#### 单播(Unicast)

单播最大的特点就是 1 对 1，早期的固定电话就是单播的一个例子，单播示意图如下

![](https://notes-pic-cjs.oss-cn-chengdu.aliyuncs.com/obsidian/image_IFCD1bwqqW.png)

### 广播(Broadcast)

我们一般小时候经常会跳`广播体操`，这就是广播的一个事例，主机和与他连接的所有端系统相连，主机将信号发送给所有的端系统。

![](https://notes-pic-cjs.oss-cn-chengdu.aliyuncs.com/obsidian/image_fFY6qUuzMp.png)

#### 多播(Multicast)

多播与广播很类似，也是将消息发送给多个接收主机，不同之处在于多播需要限定在某一组主机作为接收端。

![](https://notes-pic-cjs.oss-cn-chengdu.aliyuncs.com/obsidian/image_-BlM9EyKM6.png)

#### 任播(Anycast)

任播是在特定的多台主机中选出一个接收端的通信方式。虽然和多播很相似，但是行为与多播不同，任播是从许多目标机群中选出一台最符合网络条件的主机作为目标主机发送消息。然后被选中的特定主机将返回一个单播信号，然后再与目标主机进行通信。

![](https://notes-pic-cjs.oss-cn-chengdu.aliyuncs.com/obsidian/image_VSFx7LmKnU.png)
