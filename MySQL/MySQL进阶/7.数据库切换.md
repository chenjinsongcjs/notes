# 数据库切换

![](https://notes-pic-cjs.oss-cn-chengdu.aliyuncs.com/obsidian/image_dseWmQ-yYy.png)

-   切换策略（主从角色切换）

![](https://notes-pic-cjs.oss-cn-chengdu.aliyuncs.com/obsidian/image_X-UI7qWhWj.png)

![](https://notes-pic-cjs.oss-cn-chengdu.aliyuncs.com/obsidian/image_ts8OTR5EQ6.png)

![](https://notes-pic-cjs.oss-cn-chengdu.aliyuncs.com/obsidian/image_1uFDTyWdG8.png)

![](https://notes-pic-cjs.oss-cn-chengdu.aliyuncs.com/obsidian/image_ZINRR35sXh.png)

![](https://notes-pic-cjs.oss-cn-chengdu.aliyuncs.com/obsidian/image_jow3iyrOR0.png)

-   业务连接切换

![](https://notes-pic-cjs.oss-cn-chengdu.aliyuncs.com/obsidian/image_F31DXJX45W.png)

![](https://notes-pic-cjs.oss-cn-chengdu.aliyuncs.com/obsidian/image_aSsFMwGuPz.png)

![](https://notes-pic-cjs.oss-cn-chengdu.aliyuncs.com/obsidian/image_6VsaidaDKR.png)

![](https://notes-pic-cjs.oss-cn-chengdu.aliyuncs.com/obsidian/image_oPlgTWqJIF.png)

![](https://notes-pic-cjs.oss-cn-chengdu.aliyuncs.com/obsidian/image_eBgbjO6w-J.png)

![](https://notes-pic-cjs.oss-cn-chengdu.aliyuncs.com/obsidian/image_bKEkJ48BFj.png)

## 如何自动进行主从切换（角色）

-   写脚本完成主从切换

![](https://notes-pic-cjs.oss-cn-chengdu.aliyuncs.com/obsidian/image_I7tQCA6Tev.png)

![](https://notes-pic-cjs.oss-cn-chengdu.aliyuncs.com/obsidian/image_9NGZVEGNGZ.png)

![](https://notes-pic-cjs.oss-cn-chengdu.aliyuncs.com/obsidian/image_uXKx6hUVam.png)

![](https://notes-pic-cjs.oss-cn-chengdu.aliyuncs.com/obsidian/image_tvdHLkaHLC.png)

![](https://notes-pic-cjs.oss-cn-chengdu.aliyuncs.com/obsidian/image_3ZqegK_Y2a.png)

![](https://notes-pic-cjs.oss-cn-chengdu.aliyuncs.com/obsidian/image_rh8yhR0bws.png)

![](https://notes-pic-cjs.oss-cn-chengdu.aliyuncs.com/obsidian/image_58CduDZeUz.png)

-   一次性操作，之后MHA退出等待维修

![](https://notes-pic-cjs.oss-cn-chengdu.aliyuncs.com/obsidian/image_YQAd22r4Ll.png)

![](https://notes-pic-cjs.oss-cn-chengdu.aliyuncs.com/obsidian/image_vp-otWVrv_.png)

## 高可用了，为什么集群还是会挂

![](https://notes-pic-cjs.oss-cn-chengdu.aliyuncs.com/obsidian/image_W9qhEo2bnL.png)

![](https://notes-pic-cjs.oss-cn-chengdu.aliyuncs.com/obsidian/image_2eOYpdYhei.png)

![](https://notes-pic-cjs.oss-cn-chengdu.aliyuncs.com/obsidian/image_RqNOahMoU4.png)

![](https://notes-pic-cjs.oss-cn-chengdu.aliyuncs.com/obsidian/image_wOsM80Nx_h.png)

![](https://notes-pic-cjs.oss-cn-chengdu.aliyuncs.com/obsidian/image_WwtDeQFMqB.png)
